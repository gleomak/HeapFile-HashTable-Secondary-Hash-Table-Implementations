# <p style="text-align: center;">ΥΣΒΔ PROJECT 1-2</p>

## Γιώργος Λεωνίδας Μακρυγιάννης 1115201900105

### Συναρτήσεις HP (σωρού (heap file)) :

#### Γενικά :

- Η δομή **HP_info** αποθηκεύει τον **τύπο** του αρχείου, τον **αριθμό** του αρχείου, τον **αριθμό** 
του **τελευταίου μπλοκ** που πρέπει να γίνει η εκχώρηση, το **offset**(δηλαδή το πόσα byte έχουμε διαθέσιμα για records)
και έναν **pointer** στο **πρώτο block** που θα είναι **pinned** απο τη **HP_OpenFile** μέχρι τη **HP_CloseFile**.
- Η δομή **HP_block_info** αποθηκεύεται στο τέλος κάθε block, και συγκρατεί πληροφορίες που αφορούν 
τον **αριθμό** των **records** που έχει το συγκεκριμένο block, τον **μέγιστο αριθμό εγγραφών** που μπορούν να
αποθηκευτούν στο συγκεκριμένο block, καθώς και έναν **δείκτη** στο επόμενο overflow block.
- H συνάρτηση **printEntries** είναι **βοηθητική** και χρησιμοποιείται σε περίπτωση που θέλουμε να εκτυπώσουμε
όλες τις εγγραφές απο όλα τα block.
- Γίνεται **error_checking** με την **CALL_BF** η οποία επιστρέφει **-1** σε περίπτωση που πάει κάτι **λάθος**.
Για την **HP_OpenFile** χρησιμοποιείται η **CALL_BF2** η οποία επιστρέφει **NULL** σε περίπτωση **λάθους**.

#### HP_CreateFile :

- H **HP_CreateFile** δημιουργεί ενα αρχείο BF με αναγνωριστικό όνομα filename και αρχικοποιούνται οι δομές
**HP_info** και **HP_block_info** που θα μπούνε στο πρώτο μπλοκ και θα χρησιμοποιηθούν καθ'όλη τη διάρκεια εκχώρησης
και εύρεσης εγγραφών. 
- Οι δομές γίνονται copied με τη **memcpy** και έπειτα γίνονται free και το αρχείο κλείνει στο τέλος της συνάρτησης.

#### HP_OpenFile : 

- Στη **HP_OpenFIle** γίνεται re-opened το αρχείο με το χαρακτηριστικό όνομα filename, γίνεται **pinned** το πρώτο block
που περιέχει τη **HP_info** και **ενημερώνεται** το χαρακτηριστικό **fileDesc** του αρχείου
καθώς και ο **pointer** που θα δείχνει στο **πρώτο block**. 

#### HP_CloseFile :

- Στην **HP_CloseFile** , γίνεται **dirty, unpinned & destroyed** το **πρώτο block** του αρχείου και κλείνει
το αρχείο με την βοήθεια της συνάρτησης **BF_CloseFile**.

#### ΗP_InsertEntry : 

- Στη **HP_InsertEntry** γίνεται έλεγχος αμα βρισκόμαστε στο πρώτο block. Αν **Ναι** τότε δεν κάνουμε
**ΒF_GET_BLOCK** καθώς το πρώτο block το έχουμε ήδη στη μνήμη. Ίδιος έλεγχος γίνεται και στο τέλος ώστε να μην γίνει 
**destroyed** το **πρώτο** block και έχουμε προβλήματα στην υλοποίηση.
- Σε περίπτωση που είναι η **πρώτη εγγραφή** ή το **block** που βρισκόμαστε **έχει γεμίσει**, Δημιουργείται ένα επιπλέον block,
αρχικοποιείται, και η εγγραφή αποθηκεύεται στο νέο block. Ενημερώνεται επίσης ο δείκτης του προηγούμενου block ώστε
να δείχνει στο καινούργιο.

#### HP_GetAllEntries :

- Η **HP_GetAllEntries** κάνει **iterate** τα blocks μέχρι να βρεθεί η εγγραφή με το επιθυμητό id και επιστρέφει τον
αριθμό του block που βρέθηκε η εγγραφή. Αν τελειώσει το iteration και δεν βρεθεί η εγγραφή τότε επιστρέφεται -1.
